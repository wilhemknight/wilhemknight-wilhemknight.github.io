_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[201],{"7ljp":function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return f}));var r=n("q1tI"),o=n.n(r);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=o.a.createContext({}),s=function(e){var t=o.a.useContext(p),n=t;return e&&(n="function"===typeof e?e(t):l(l({},t),e)),n},b=function(e){var t=s(e.components);return o.a.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},d=o.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,i=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),b=s(n),d=r,f=b["".concat(i,".").concat(d)]||b[d]||u[d]||a;return n?o.a.createElement(f,l(l({ref:t},p),{},{components:n})):o.a.createElement(f,l({ref:t},p))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"===typeof e||r){var a=n.length,i=new Array(a);i[0]=d;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"===typeof e?e:r,i[1]=l;for(var p=2;p<a;p++)i[p]=n[p];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},Dq43:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/push-notifications/using-fcm",function(){return n("x2xY")}])},HALo:function(e,t,n){"use strict";function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}n.d(t,"a",(function(){return r}))},Qetd:function(e,t,n){"use strict";var r=Object.assign.bind(Object);e.exports=r,e.exports.default=e.exports},dhJC:function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}n.d(t,"a",(function(){return r}))},x2xY:function(e,t,n){"use strict";n.r(t),n.d(t,"meta",(function(){return l})),n.d(t,"headings",(function(){return c})),n.d(t,"default",(function(){return s}));var r=n("HALo"),o=n("dhJC"),a=(n("q1tI"),n("7ljp")),i=["components"],l={title:"Using FCM for Push Notifications",sidebar_title:"Using FCM"},c=[{depth:2,type:"text",title:"Client Setup"},{depth:3,type:"text",title:"Bare projects"},{depth:2,type:"text",title:"Uploading Server Credentials"},{depth:2,type:"text",title:"See also"}],p={meta:l,headings:c};function s(e){var t=e.components,n=Object(o.a)(e,i);return Object(a.b)("wrapper",Object(r.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Firebase Cloud Messaging is required for all managed and bare workflow Android apps made with Expo"),", unless you're still running your app in the Expo Go app. To set up your Expo Android app to get push notifications using your own FCM credentials, follow this guide closely."),Object(a.b)("p",null,"Note that FCM is not currently available for Expo iOS apps."),Object(a.b)("h2",{id:"client-setup"},"Client Setup"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},Object(a.b)("p",{parentName:"li"},"If you have not already created a Firebase project for your app, do so now by clicking on ",Object(a.b)("strong",{parentName:"p"},"Add project")," in the ",Object(a.b)("a",{parentName:"p",href:"https://console.firebase.google.com/"},"Firebase Console"),".")),Object(a.b)("li",{parentName:"ol"},Object(a.b)("p",{parentName:"li"},"In your new project console, click ",Object(a.b)("strong",{parentName:"p"},"Add Firebase to your Android app")," and follow the setup steps. ",Object(a.b)("strong",{parentName:"p"},"Make sure that the Android package name you enter is the same as the value of ",Object(a.b)("inlineCode",{parentName:"strong"},"android.package")," in your app.json."))),Object(a.b)("li",{parentName:"ol"},Object(a.b)("p",{parentName:"li"},"Download the ",Object(a.b)("inlineCode",{parentName:"p"},"google-services.json")," file and place it in your Expo app's root directory.")),Object(a.b)("li",{parentName:"ol"},Object(a.b)("p",{parentName:"li"},"In your app.json, add an ",Object(a.b)("inlineCode",{parentName:"p"},"android.googleServicesFile")," field with the relative path to the ",Object(a.b)("inlineCode",{parentName:"p"},"google-services.json")," file you just downloaded. If you placed it in the root directory, this will probably look like"),Object(a.b)("pre",{parentName:"li"},Object(a.b)("code",{parentName:"pre",className:"language-javascript"},'{\n  ...\n  "android": {\n    "googleServicesFile": "./google-services.json",\n    ...\n  }\n}\n'))),Object(a.b)("li",{parentName:"ol"},Object(a.b)("p",{parentName:"li"},"Confirm that your API key in ",Object(a.b)("inlineCode",{parentName:"p"},"google-services.json"),' has the correct "API restrictions" in the ',Object(a.b)("a",{parentName:"p",href:"https://console.cloud.google.com/apis/credentials"},"Google Cloud Platform API Credentials console"),". For push notifications to work correctly, Firebase requires the API key to either be unrestricted (the key can call any API), or have access to both ",Object(a.b)("inlineCode",{parentName:"p"},"Firebase Cloud Messaging API")," and ",Object(a.b)("inlineCode",{parentName:"p"},"Firebase Installations API"),". The API key can be found under the ",Object(a.b)("inlineCode",{parentName:"p"},"client.api_key.current_key")," field in ",Object(a.b)("inlineCode",{parentName:"p"},"google-services.json"),"."),Object(a.b)("pre",{parentName:"li"},Object(a.b)("code",{parentName:"pre",className:"language-javascript"},'{\n  ...\n  "client": [\n    {\n      "api_key": [\n        {\n          "current_key" "<your Google Cloud Platform API key>",\n        }\n      ],\n    }\n  ]\n}\n')),Object(a.b)("blockquote",{parentName:"li"},Object(a.b)("p",{parentName:"blockquote"},Object(a.b)("strong",{parentName:"p"},"Note:")," Firebase will create an API key in the Google Cloud Platform console with a name like ",Object(a.b)("inlineCode",{parentName:"p"},"Android key (auto created by Firebase)"),". ",Object(a.b)("strong",{parentName:"p"},"This is not always the same key as the one found in ",Object(a.b)("inlineCode",{parentName:"strong"},"google-services.json"),". Always confirm your key and associated restrictions in the Google Cloud Platform console.")))),Object(a.b)("li",{parentName:"ol"},Object(a.b)("p",{parentName:"li"},"Finally, make a new build of your app by running ",Object(a.b)("inlineCode",{parentName:"p"},"eas build --platform android")," (or ",Object(a.b)("inlineCode",{parentName:"p"},"expo build:android")," if you're using the classic build system)."))),Object(a.b)("h3",{id:"bare-projects"},"Bare projects"),Object(a.b)("p",null,"If you do the above setup before ejecting to bare, your FCM notifications will continue to work properly without any extra steps after ejecting. However, if your project is already ejected to bare and you want to set up FCM retroactively, you'll need to:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",{parentName:"li",href:"/../../../../../../guides/setup-native-firebase/#android-1"},"Set up Firebase in your Android project")),Object(a.b)("li",{parentName:"ul"},"Copy the same ",Object(a.b)("inlineCode",{parentName:"li"},"google-services.json")," file into the ",Object(a.b)("inlineCode",{parentName:"li"},"android/app")," directory. If that file already exists, you should overwrite it.")),Object(a.b)("h2",{id:"uploading-server-credentials"},"Uploading Server Credentials"),Object(a.b)("p",null,"In order for Expo to send notifications from our servers using your credentials, you'll need to upload your secret server key. You can find this key in the Firebase Console for your project:"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},Object(a.b)("p",{parentName:"li"},"At the top of the sidebar, click the ",Object(a.b)("strong",{parentName:"p"},"gear icon")," to the right of ",Object(a.b)("strong",{parentName:"p"},"Project Overview")," to go to your project settings.")),Object(a.b)("li",{parentName:"ol"},Object(a.b)("p",{parentName:"li"},"Click on the ",Object(a.b)("strong",{parentName:"p"},"Cloud Messaging")," tab in the Settings pane.")),Object(a.b)("li",{parentName:"ol"},Object(a.b)("p",{parentName:"li"},"Copy the token listed next to ",Object(a.b)("strong",{parentName:"p"},"Server key"),".")),Object(a.b)("li",{parentName:"ol"},Object(a.b)("p",{parentName:"li"},"Run ",Object(a.b)("inlineCode",{parentName:"p"},"expo push:android:upload --api-key <your-token-here>"),", replacing ",Object(a.b)("inlineCode",{parentName:"p"},"<your-token-here>")," with the string you just copied. We'll store your token securely on our servers, where it will only be accessed when you send a push notification."))),Object(a.b)("p",null,"That's it -- users who run this new version of the app will now receive notifications through FCM using your project's credentials. You just send the push notifications as you normally would (see ",Object(a.b)("a",{parentName:"p",href:"/push-notifications/sending-notifications/"},"guide"),"). We'll take care of choosing the correct service to send the notification."),Object(a.b)("h2",{id:"see-also"},"See also"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"Having trouble? Visit ",Object(a.b)("a",{parentName:"li",href:"/push-notifications/faq/"},"Expo's notification FAQ page"))))}s.isMDXComponent=!0}},[["Dq43",1,0]]]);