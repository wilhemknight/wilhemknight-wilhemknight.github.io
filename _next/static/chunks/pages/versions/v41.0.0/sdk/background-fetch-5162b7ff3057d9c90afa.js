_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[790],{"hWv/":function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/versions/v41.0.0/sdk/background-fetch",function(){return a("ytvW")}])},ytvW:function(e,t,a){"use strict";a.r(t),a.d(t,"meta",(function(){return c})),a.d(t,"headings",(function(){return b})),a.d(t,"default",(function(){return u}));var n=a("HALo"),r=a("dhJC"),o=(a("q1tI"),a("7ljp")),s=a("hykZ"),i=["components"],c={title:"BackgroundFetch",sourceCodeUrl:"https://github.com/expo/expo/tree/sdk-41/packages/expo-background-fetch"},b=[{depth:2,type:"text",title:"Known issues"},{depth:2,type:"text",title:"Installation"},{depth:2,type:"text",title:"Configuration"},{depth:2,type:"text",title:"API"},{depth:2,type:"text",title:"Methods"},{depth:3,type:"inlineCode",title:"BackgroundFetch.getStatusAsync()"},{depth:4,type:"text",title:"Returns"},{depth:3,type:"inlineCode",title:"BackgroundFetch.registerTaskAsync(taskName, options)"},{depth:4,type:"text",title:"Arguments"},{depth:4,type:"text",title:"Returns"},{depth:4,type:"text",title:"Task parameters"},{depth:3,type:"inlineCode",title:"BackgroundFetch.unregisterTaskAsync(taskName)"},{depth:4,type:"text",title:"Arguments"},{depth:4,type:"text",title:"Returns"},{depth:3,type:"inlineCode",title:"BackgroundFetch.setMinimumIntervalAsync(minimumInterval)"},{depth:4,type:"text",title:"Arguments"},{depth:4,type:"text",title:"Returns"}],l={meta:c,headings:b};function u(e){var t=e.components,a=Object(r.a)(e,i);return Object(o.b)("wrapper",Object(n.a)({},l,a,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},Object(o.b)("inlineCode",{parentName:"strong"},"expo-background-fetch"))," provides an API to perform ",Object(o.b)("a",{parentName:"p",href:"https://developer.apple.com/documentation/uikit/core_app/managing_your_app_s_life_cycle/preparing_your_app_to_run_in_the_background/updating_your_app_with_background_app_refresh"},"background fetch")," tasks, allowing you to run specific code periodically in the background to update your app. This module uses ",Object(o.b)("a",{parentName:"p",href:"/versions/v41.0.0/sdk/task-manager/"},"TaskManager")," Native API under the hood."),Object(o.b)(s.a,{android:!0,emulator:!0,ios:!0,simulator:!0,mdxType:"PlatformsSection"}),Object(o.b)("h2",{id:"known-issues"},"Known issues"),Object(o.b)("p",null,"BackgroundFetch only works when the app is backgrounded, not if the app was terminated or upon device reboot. ",Object(o.b)("a",{parentName:"p",href:"https://github.com/expo/expo/issues/3582"},"Here is the relevant GitHub issue")),Object(o.b)("h2",{id:"installation"},"Installation"),Object(o.b)("p",null,"For ",Object(o.b)("a",{parentName:"p",href:"/introduction/managed-vs-bare/#managed-workflow"},"managed")," apps, you'll need to run ",Object(o.b)("inlineCode",{parentName:"p"},"expo install expo-background-fetch"),". To use it in ",Object(o.b)("a",{parentName:"p",href:"/introduction/managed-vs-bare/#bare-workflow"},"bare")," React Native app, follow its ",Object(o.b)("a",{parentName:"p",href:"https://github.com/expo/expo/tree/main/packages/expo-background-fetch"},"installation instructions"),";"),Object(o.b)("h2",{id:"configuration"},"Configuration"),Object(o.b)("p",null,"In order to use ",Object(o.b)("inlineCode",{parentName:"p"},"BackgroundFetch")," API in standalone, detached and bare apps on iOS, your app has to include background mode in the ",Object(o.b)("strong",{parentName:"p"},"Info.plist")," file. See ",Object(o.b)("a",{parentName:"p",href:"/versions/v41.0.0/sdk/task-manager/#configuration-for-standalone-apps"},"background tasks configuration guide")," for more details."),Object(o.b)("p",null,"On Android, this module might listen when the device is starting up. It's necessary to continue working on tasks started with ",Object(o.b)("inlineCode",{parentName:"p"},"startOnBoot"),'. It also keeps devices "awake" that are going idle and asleep fast, to improve reliability of the tasks. Because of this both the ',Object(o.b)("inlineCode",{parentName:"p"},"RECEIVE_BOOT_COMPLETED")," and ",Object(o.b)("inlineCode",{parentName:"p"},"WAKE_LOCK")," permissions are added automatically."),Object(o.b)("h2",{id:"api"},"API"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"import * as BackgroundFetch from 'expo-background-fetch';\n")),Object(o.b)("h2",{id:"methods"},"Methods"),Object(o.b)("h3",{id:"backgroundfetchgetstatusasync"},Object(o.b)("inlineCode",{parentName:"h3"},"BackgroundFetch.getStatusAsync()")),Object(o.b)("p",null,"Gets a status of background fetch."),Object(o.b)("h4",{id:"returns"},"Returns"),Object(o.b)("p",null,"Returns a promise resolving to one of these values:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"BackgroundFetch.Status.Restricted")," \u2014 Background updates are unavailable and the user cannot enable them again. This status can occur when, for example, parental controls are in effect for the current user."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"BackgroundFetch.Status.Denied")," - The user explicitly disabled background behavior for this app or for the whole system."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"BackgroundFetch.Status.Available")," - Background updates are available for the app.")),Object(o.b)("h3",{id:"backgroundfetchregistertaskasynctaskname-options"},Object(o.b)("inlineCode",{parentName:"h3"},"BackgroundFetch.registerTaskAsync(taskName, options)")),Object(o.b)("p",null,"Registers background fetch task with given name. Registered tasks are saved in persistent storage and restored once the app is initialized."),Object(o.b)("h4",{id:"arguments"},"Arguments"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"taskName (",Object(o.b)("em",{parentName:"strong"},"string"),")")," -- Name of the task to register. The task needs to be defined first - see ",Object(o.b)("a",{parentName:"li",href:"/versions/v41.0.0/sdk/task-manager/#taskmanagerdefinetasktaskname-task"},"TaskManager.defineTask")," for more details."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"options (",Object(o.b)("em",{parentName:"strong"},"object"),")")," -- An object of options:",Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"minimumInterval (",Object(o.b)("em",{parentName:"strong"},"number"),")")," -- Inexact interval in seconds between subsequent repeats of the background fetch alarm. The final interval may differ from the specified one to minimize wakeups and battery usage.\nOn Android it defaults to ",Object(o.b)("strong",{parentName:"li"},"15 minutes"),". On iOS it calls ",Object(o.b)("a",{parentName:"li",href:"/versions/v41.0.0/sdk/background-fetch/#backgroundfetchsetminimumintervalasyncminimuminterval"},"BackgroundFetch.setMinimumIntervalAsync")," behind the scenes and the default value is the smallest fetch interval supported by the system (",Object(o.b)("strong",{parentName:"li"},"10-15 minutes"),")."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"stopOnTerminate (",Object(o.b)("em",{parentName:"strong"},"boolean"),")")," -- Whether to stop receiving background fetch events after user terminates the app. Defaults to ",Object(o.b)("inlineCode",{parentName:"li"},"true"),". (",Object(o.b)("strong",{parentName:"li"},"Android only"),")"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"startOnBoot (",Object(o.b)("em",{parentName:"strong"},"boolean"),")")," -- Whether to restart background fetch events when the device has finished booting. Defaults to ",Object(o.b)("inlineCode",{parentName:"li"},"false"),". (",Object(o.b)("strong",{parentName:"li"},"Android only"),")")))),Object(o.b)("h4",{id:"returns-1"},"Returns"),Object(o.b)("p",null,"Returns a promise that resolves once the task is registered and rejects in case of any errors."),Object(o.b)("h4",{id:"task-parameters"},"Task parameters"),Object(o.b)("p",null,"Background fetch task receives no data, but your task should return a value that best describes the results of your background fetch work."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"BackgroundFetch.Result.NoData")," - There was no new data to download."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"BackgroundFetch.Result.NewData")," - New data was successfully downloaded."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"BackgroundFetch.Result.Failed")," - An attempt to download data was made but that attempt failed.")),Object(o.b)("p",null,"This return value is to let iOS know what the result of your background fetch was, so the platform can better schedule future background fetches. Also, your app has up to 30 seconds to perform the task, otherwise your app will be terminated and future background fetches may be delayed."),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-javascript"},"import * as BackgroundFetch from 'expo-background-fetch';\nimport * as TaskManager from 'expo-task-manager';\n\nTaskManager.defineTask(YOUR_TASK_NAME, () => {\n  try {\n    const receivedNewData = // do your background fetch here\n    return receivedNewData ? BackgroundFetch.Result.NewData : BackgroundFetch.Result.NoData;\n  } catch (error) {\n    return BackgroundFetch.Result.Failed;\n  }\n});\n")),Object(o.b)("h3",{id:"backgroundfetchunregistertaskasynctaskname"},Object(o.b)("inlineCode",{parentName:"h3"},"BackgroundFetch.unregisterTaskAsync(taskName)")),Object(o.b)("p",null,"Unregisters background fetch task, so the application will no longer be executing this task."),Object(o.b)("h4",{id:"arguments-1"},"Arguments"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"taskName (",Object(o.b)("em",{parentName:"strong"},"string"),")")," -- Name of the task to unregister.")),Object(o.b)("h4",{id:"returns-2"},"Returns"),Object(o.b)("p",null,"A promise resolving when the task is fully unregistered."),Object(o.b)("h3",{id:"backgroundfetchsetminimumintervalasyncminimuminterval"},Object(o.b)("inlineCode",{parentName:"h3"},"BackgroundFetch.setMinimumIntervalAsync(minimumInterval)")),Object(o.b)("p",null,"Sets the minimum number of seconds that must elapse before another background fetch can be initiated. This value is advisory only and does not indicate the exact amount of time expected between fetch operations."),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"This method doesn't take any effect on Android.")),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"It is a global value which means that it can overwrite settings from another application opened through Expo Go.")),Object(o.b)("h4",{id:"arguments-2"},"Arguments"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"minimumInterval (",Object(o.b)("em",{parentName:"strong"},"number"),")")," -- Number of seconds that must elapse before another background fetch can be called.")),Object(o.b)("h4",{id:"returns-3"},"Returns"),Object(o.b)("p",null,"A promise resolving once the minimum interval is set."))}u.isMDXComponent=!0}},[["hWv/",1,0,2,3,4,5]]]);