_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[856],{"5cDn":function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/versions/v41.0.0/sdk/segment",function(){return n("IjD9")}])},IjD9:function(e,t,n){"use strict";n.r(t),n.d(t,"meta",(function(){return p})),n.d(t,"headings",(function(){return b})),n.d(t,"default",(function(){return l}));var a=n("HALo"),i=n("dhJC"),o=(n("q1tI"),n("7ljp")),r=n("HCau"),s=n("hykZ"),c=["components"],p={title:"Segment",sourceCodeUrl:"https://github.com/expo/expo/tree/sdk-41/packages/expo-analytics-segment"},b=[{depth:2,type:"text",title:"Installation"},{depth:2,type:"text",title:"API"},{depth:3,type:"inlineCode",title:"Segment.initialize({ androidWriteKey, iosWriteKey })"},{depth:4,type:"text",title:"Arguments"},{depth:3,type:"inlineCode",title:"Segment.identify(userId)"},{depth:4,type:"text",title:"Arguments"},{depth:3,type:"inlineCode",title:"Segment.identifyWithTraits(userId, traits, options?)"},{depth:4,type:"text",title:"Arguments"},{depth:3,type:"inlineCode",title:"Segment.reset()"},{depth:3,type:"inlineCode",title:"Segment.track(event)"},{depth:4,type:"text",title:"Arguments"},{depth:3,type:"inlineCode",title:"Segment.trackWithProperties(event, properties, options?)"},{depth:4,type:"text",title:"Arguments"},{depth:3,type:"inlineCode",title:"Segment.group(groupId)"},{depth:4,type:"text",title:"Arguments"},{depth:3,type:"inlineCode",title:"Segment.groupWithTraits(groupId, traits, options?)"},{depth:4,type:"text",title:"Arguments"},{depth:3,type:"inlineCode",title:"Segment.alias(newId, options?)"},{depth:4,type:"text",title:"Arguments"},{depth:4,type:"text",title:"Returns"},{depth:3,type:"inlineCode",title:"Segment.screen(screenName)"},{depth:4,type:"text",title:"Arguments"},{depth:3,type:"inlineCode",title:"Segment.screenWithProperties(screenName, properties, options?)"},{depth:3,type:"inlineCode",title:"Segment.flush()"},{depth:3,type:"text",title:"Opting out (enabling/disabling all tracking)"}],m={meta:p,headings:b};function l(e){var t=e.components,n=Object(i.a)(e,c);return Object(o.b)("wrapper",Object(a.a)({},m,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},Object(o.b)("inlineCode",{parentName:"strong"},"expo-analytics-segment"))," provides access to ",Object(o.b)("a",{parentName:"p",href:"https://segment.com/"},"https://segment.com/")," mobile analytics. Wraps Segment's ",Object(o.b)("a",{parentName:"p",href:"https://segment.com/docs/sources/mobile/ios/"},"iOS")," and ",Object(o.b)("a",{parentName:"p",href:"https://segment.com/docs/sources/mobile/android/"},"Android")," sources."),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},Object(o.b)("strong",{parentName:"p"},"Note:")," Session tracking may not work correctly when running Experiences in the main Expo app. It will work correctly if you create a standalone app.")),Object(o.b)(s.a,{android:!0,emulator:!0,ios:!0,simulator:!0,mdxType:"PlatformsSection"}),Object(o.b)("h2",{id:"installation"},"Installation"),Object(o.b)(r.b,{packageName:"expo-analytics-segment",mdxType:"InstallSection"}),Object(o.b)("h2",{id:"api"},"API"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"import * as Segment from 'expo-analytics-segment';\n")),Object(o.b)("h3",{id:"segmentinitialize-androidwritekey-ioswritekey-"},Object(o.b)("inlineCode",{parentName:"h3"},"Segment.initialize({ androidWriteKey, iosWriteKey })")),Object(o.b)("p",null,"Segment requires separate write keys for iOS and Android. You will need to log in to Segment to receive these ",Object(o.b)("a",{parentName:"p",href:"https://segment.com/docs/guides/setup/how-do-i-find-my-write-key/"},"https://segment.com/docs/guides/setup/how-do-i-find-my-write-key/")),Object(o.b)("h4",{id:"arguments"},"Arguments"),Object(o.b)("p",null,"Accepts an object with the following keys:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"androidWriteKey (",Object(o.b)("em",{parentName:"strong"},"string"),")")," \u2013 Write key for Android source."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"iosWriteKey (",Object(o.b)("em",{parentName:"strong"},"string"),")")," \u2013 Write key for iOS source.")),Object(o.b)("h3",{id:"segmentidentifyuserid"},Object(o.b)("inlineCode",{parentName:"h3"},"Segment.identify(userId)")),Object(o.b)("p",null,"Associates the current user with a user ID. Call this after calling ",Object(o.b)("a",{parentName:"p",href:"/versions/v41.0.0/sdk/segment/#exposegmentinitialize",title:"Segment.initialize"},Object(o.b)("inlineCode",{parentName:"a"},"Segment.initialize()"))," but before other segment calls. See ",Object(o.b)("a",{parentName:"p",href:"https://segment.com/docs/spec/identify/"},"https://segment.com/docs/spec/identify/"),"."),Object(o.b)("h4",{id:"arguments-1"},"Arguments"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"userId (",Object(o.b)("em",{parentName:"strong"},"string"),")")," \u2013 User ID for the current user.")),Object(o.b)("h3",{id:"segmentidentifywithtraitsuserid-traits-options"},Object(o.b)("inlineCode",{parentName:"h3"},"Segment.identifyWithTraits(userId, traits, options?)")),Object(o.b)("h4",{id:"arguments-2"},"Arguments"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"userId (",Object(o.b)("em",{parentName:"strong"},"string"),")")," \u2013 User ID for the current user."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"traits (",Object(o.b)("em",{parentName:"strong"},"object"),")")," \u2013 A map of custom properties."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"options (",Object(o.b)("em",{parentName:"strong"},"object"),")")," \u2013 ",Object(o.b)("em",{parentName:"li"},"(optional)")," map that can include any of ",Object(o.b)("a",{parentName:"li",href:"https://segment.com/docs/connections/spec/common/"},"these common fields"),". Defaults to ",Object(o.b)("inlineCode",{parentName:"li"},"null"),".")),Object(o.b)("h3",{id:"segmentreset"},Object(o.b)("inlineCode",{parentName:"h3"},"Segment.reset()")),Object(o.b)("p",null,"Clears the current user. See ",Object(o.b)("a",{parentName:"p",href:"https://segment.com/docs/sources/mobile/ios/#reset"},"https://segment.com/docs/sources/mobile/ios/#reset"),"."),Object(o.b)("h3",{id:"segmenttrackevent"},Object(o.b)("inlineCode",{parentName:"h3"},"Segment.track(event)")),Object(o.b)("p",null,"Log an event to Segment. See ",Object(o.b)("a",{parentName:"p",href:"https://segment.com/docs/spec/track/"},"https://segment.com/docs/spec/track/"),"."),Object(o.b)("h4",{id:"arguments-3"},"Arguments"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"event (",Object(o.b)("em",{parentName:"strong"},"string"),")")," \u2013 The event name.")),Object(o.b)("h3",{id:"segmenttrackwithpropertiesevent-properties-options"},Object(o.b)("inlineCode",{parentName:"h3"},"Segment.trackWithProperties(event, properties, options?)")),Object(o.b)("p",null,"Log an event to Segment with custom properties. See ",Object(o.b)("a",{parentName:"p",href:"https://segment.com/docs/spec/track/"},"https://segment.com/docs/spec/track/"),"."),Object(o.b)("h4",{id:"arguments-4"},"Arguments"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"event (",Object(o.b)("em",{parentName:"strong"},"string"),")")," \u2013 The event name."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"properties (",Object(o.b)("em",{parentName:"strong"},"object"),")")," \u2013 A map of custom properties."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"options (",Object(o.b)("em",{parentName:"strong"},"object"),")")," \u2013 ",Object(o.b)("em",{parentName:"li"},"(optional)")," map that can include any of ",Object(o.b)("a",{parentName:"li",href:"https://segment.com/docs/connections/spec/common/"},"these common fields"),". Defaults to ",Object(o.b)("inlineCode",{parentName:"li"},"null"),".")),Object(o.b)("h3",{id:"segmentgroupgroupid"},Object(o.b)("inlineCode",{parentName:"h3"},"Segment.group(groupId)")),Object(o.b)("p",null,"Associate the user with a group. See ",Object(o.b)("a",{parentName:"p",href:"https://segment.com/docs/spec/group/"},"https://segment.com/docs/spec/group/"),"."),Object(o.b)("h4",{id:"arguments-5"},"Arguments"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"groupId (",Object(o.b)("em",{parentName:"strong"},"string"),")")," \u2013 ID of the group.")),Object(o.b)("h3",{id:"segmentgroupwithtraitsgroupid-traits-options"},Object(o.b)("inlineCode",{parentName:"h3"},"Segment.groupWithTraits(groupId, traits, options?)")),Object(o.b)("p",null,"Associate the user with a group with traits. See ",Object(o.b)("a",{parentName:"p",href:"https://segment.com/docs/spec/group/"},"https://segment.com/docs/spec/group/"),"."),Object(o.b)("h4",{id:"arguments-6"},"Arguments"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"groupId (",Object(o.b)("em",{parentName:"strong"},"string"),")")," \u2013 ID of the group."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"traits (",Object(o.b)("em",{parentName:"strong"},"object"),")")," \u2013 free-form dictionary of traits of the group."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"options (",Object(o.b)("em",{parentName:"strong"},"object"),")")," \u2013 ",Object(o.b)("em",{parentName:"li"},"(optional)")," map that can include any of ",Object(o.b)("a",{parentName:"li",href:"https://segment.com/docs/connections/spec/common/"},"these common fields"),". Defaults to ",Object(o.b)("inlineCode",{parentName:"li"},"null"),".")),Object(o.b)("h3",{id:"segmentaliasnewid-options"},Object(o.b)("inlineCode",{parentName:"h3"},"Segment.alias(newId, options?)")),Object(o.b)("p",null,"Associate current identity with a new identifier. See ",Object(o.b)("a",{parentName:"p",href:"https://segment.com/docs/spec/alias/"},"https://segment.com/docs/spec/alias/"),"."),Object(o.b)("h4",{id:"arguments-7"},"Arguments"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"newId (",Object(o.b)("em",{parentName:"strong"},"string"),")")," \u2013 Identifier to associate with."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"options (",Object(o.b)("em",{parentName:"strong"},"object"),")")," \u2013 ",Object(o.b)("em",{parentName:"li"},"(optional)")," extra dictionary with options for the call, ",Object(o.b)("a",{parentName:"li",href:"https://segment.com/docs/connections/spec/common/"},"see here")," for possible configuration options. An example ",Object(o.b)("inlineCode",{parentName:"li"},"options")," object would be:")),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},'{\n  "integrations": {\n    "Sentry": {\n      "enabled": true\n    }\n  },\n  "context": {\n    "ip": "0.0.0.0"\n  }\n}\n')),Object(o.b)("h4",{id:"returns"},"Returns"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"A ",Object(o.b)("inlineCode",{parentName:"li"},"Promise")," resolving to a ",Object(o.b)("inlineCode",{parentName:"li"},"boolean")," indicating whether the method has been executed on the underlying Segment instance or not.")),Object(o.b)("h3",{id:"segmentscreenscreenname"},Object(o.b)("inlineCode",{parentName:"h3"},"Segment.screen(screenName)")),Object(o.b)("p",null,"Record that a user has seen a screen to Segment. See ",Object(o.b)("a",{parentName:"p",href:"https://segment.com/docs/spec/screen/"},"https://segment.com/docs/spec/screen/"),"."),Object(o.b)("h4",{id:"arguments-8"},"Arguments"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"screenName (",Object(o.b)("em",{parentName:"strong"},"string"),")")," \u2013 Name of the screen.")),Object(o.b)("h3",{id:"segmentscreenwithpropertiesscreenname-properties-options"},Object(o.b)("inlineCode",{parentName:"h3"},"Segment.screenWithProperties(screenName, properties, options?)")),Object(o.b)("p",null,"Record that a user has seen a screen to Segment with custom properties. See ",Object(o.b)("a",{parentName:"p",href:"https://segment.com/docs/spec/screen/"},"https://segment.com/docs/spec/screen/"),"."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"screenName (",Object(o.b)("em",{parentName:"strong"},"string"),")")," \u2013 Name of the screen."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"properties (",Object(o.b)("em",{parentName:"strong"},"object"),")")," \u2013 A map of custom properties."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"options (",Object(o.b)("em",{parentName:"strong"},"object"),")")," \u2013 ",Object(o.b)("em",{parentName:"li"},"(optional)")," map that can include any of ",Object(o.b)("a",{parentName:"li",href:"https://segment.com/docs/connections/spec/common/"},"these common fields"),". Defaults to ",Object(o.b)("inlineCode",{parentName:"li"},"null"),".")),Object(o.b)("h3",{id:"segmentflush"},Object(o.b)("inlineCode",{parentName:"h3"},"Segment.flush()")),Object(o.b)("p",null,"Manually flush the event queue. You shouldn't need to call this in most cases."),Object(o.b)("h3",{id:"opting-out-enablingdisabling-all-tracking"},"Opting out (enabling/disabling all tracking)"),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},"Depending on the audience for your app (e.g. children) or the countries where you sell your app (e.g. the EU), you may need to offer the ability for users to opt-out of analytics data collection inside your app. You can turn off forwarding to ALL destinations including Segment itself:\n(",Object(o.b)("a",{parentName:"p",href:"https://segment.com/docs/sources/mobile/ios/#opt-out"},"Source \u2013 Segment docs"),")")),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"import * as Segment from 'expo-analytics-segment';\n\nSegment.setEnabledAsync(false);\n\n// Or if they opt-back-in, you can re-enable data collection:\nSegment.setEnabledAsync(true);\n")),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},Object(o.b)("strong",{parentName:"p"},"Note:")," disabling the Segment SDK ensures that all data collection method invocations (eg. ",Object(o.b)("inlineCode",{parentName:"p"},"track"),", ",Object(o.b)("inlineCode",{parentName:"p"},"identify"),", etc) are ignored.")),Object(o.b)("p",null,"This method is only supported in standalone and detached apps. In Expo Go the promise will reject."),Object(o.b)("p",null,"The setting value will be persisted across restarts, so once you call ",Object(o.b)("inlineCode",{parentName:"p"},"setEnabledAsync(false)"),", Segment won't track the users even when the app restarts. To check whether tracking is enabled, use ",Object(o.b)("inlineCode",{parentName:"p"},"Segment.getEnabledAsync()")," which returns a promise which should resolve to a boolean."))}l.isMDXComponent=!0}},[["5cDn",1,0,2,3,4,5,6]]]);