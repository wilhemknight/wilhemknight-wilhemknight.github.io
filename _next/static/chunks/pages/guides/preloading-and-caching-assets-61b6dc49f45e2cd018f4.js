_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[153],{"+Css":function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,"a",(function(){return r}))},"1jzr":function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/guides/preloading-and-caching-assets",function(){return n("WqtG")}])},"5BX9":function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));var r=n("q1tI"),o=n("AeFk"),s=Object(r.createContext)({version:"latest",hasVersion:!1,setVersion:function(e){throw new Error("PageApiVersionContext not found")}});function a(e){var t=c(e.router.pathname),n=null!==t,a=Object(r.useCallback)((function(t){e.router.push(function(e,t){var n=c(e);return n?e.replace(n,t):e}(e.router.pathname,t))}),[]);return Object(o.c)(s.Provider,{value:{setVersion:a,hasVersion:n,version:t||"latest"}},e.children)}function i(){return Object(r.useContext)(s)}function c(e){return function(e){return e.startsWith("/versions/")}(e)?e.split("/",3).pop():null}},"6FTQ":function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,"a",(function(){return r}))},"7LId":function(e,t,n){"use strict";function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}n.d(t,"a",(function(){return o}))},"7ljp":function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return f}));var r=n("q1tI"),o=n.n(r);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=o.a.createContext({}),l=function(e){var t=o.a.useContext(p),n=t;return e&&(n="function"===typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=l(e.components);return o.a.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},b=o.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,s=e.originalType,a=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),u=l(n),b=r,f=u["".concat(a,".").concat(b)]||u[b]||d[b]||s;return n?o.a.createElement(f,i(i({ref:t},p),{},{components:n})):o.a.createElement(f,i({ref:t},p))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"===typeof e||r){var s=n.length,a=new Array(s);a[0]=b;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"===typeof e?e:r,a[1]=i;for(var p=2;p<s;p++)a[p]=n[p];return o.a.createElement.apply(null,a)}return o.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"},"8rE2":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("6FTQ");function o(e,t){if(e){if("string"===typeof e)return Object(r.a)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r.a)(e,t):void 0}}},"C+bE":function(e,t){function n(t){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?(e.exports=n=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=n=function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),n(t)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},"H+61":function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return r}))},I0q5:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r=n("z7pX"),o=n("H+61"),s=n("UlJF"),a=n("+Css"),i=n("7LId"),c=n("VIvw"),p=n("iHvq"),l=n("cpVT"),u=n("q1tI"),d=n("ufKf"),b=n("3zh3"),f=n("AeFk"),m=function(e){var t=e.size,n=void 0===t?24:t,r=e.stroke,o=void 0===r?b.palette.dark.white:r;return Object(f.c)("svg",{"aria-label":"check",width:n,height:n,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Object(f.c)("path",{d:"M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6m4-3h6v6m-11 5L21 3",stroke:o,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}))},h=n("5BX9");function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(p.a)(e);if(t){var o=Object(p.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var g="v".concat(n("kiQV").version),j=function(e){Object(i.a)(n,e);var t=y(n);function n(){var e;Object(o.a)(this,n);for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];return e=t.call.apply(t,[this].concat(i)),Object(l.a)(Object(a.a)(e),"contentRef",u.createRef()),Object(l.a)(Object(a.a)(e),"state",{ready:!1}),Object(l.a)(Object(a.a)(e),"getSelectedDocsVersion",(function(){var t=e.context.version;return"latest"===t?g:t})),Object(l.a)(Object(a.a)(e),"getSnackSdkVersion",(function(){var t=e.getSelectedDocsVersion();return"unversioned"===t&&(t=g),t.replace("v","")})),Object(l.a)(Object(a.a)(e),"getExamplesPath",(function(){return"".concat(document.location.origin,"/static/examples/").concat(e.getSelectedDocsVersion())})),Object(l.a)(Object(a.a)(e),"getDependencies",(function(){return Object(r.a)(e.props.dependencies).join(",")})),Object(l.a)(Object(a.a)(e),"getCode",(function(){return(e.contentRef.current&&e.contentRef.current.textContent||"").replace(/%%placeholder-start%%.*%%placeholder-end%%/g,"")})),e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.setState({ready:!0})}},{key:"render",value:function(){return Object(f.c)("div",null,Object(f.c)("div",{ref:this.contentRef,style:this.props.contentHidden?{display:"none"}:void 0},this.props.children),Object(f.c)("form",{action:d.a,method:"POST",target:"_blank"},Object(f.c)("input",{type:"hidden",name:"platform",value:this.props.defaultPlatform||"android"}),Object(f.c)("input",{type:"hidden",name:"name",value:this.props.label||"Example"}),Object(f.c)("input",{type:"hidden",name:"dependencies",value:this.getDependencies()}),Object(f.c)("input",{type:"hidden",name:"sdkVersion",value:this.getSnackSdkVersion()}),this.props.platforms&&Object(f.c)("input",{type:"hidden",name:"supportedPlatforms",value:this.props.platforms.join(",")}),this.state.ready&&Object(f.c)("input",{type:"hidden",name:"files",value:JSON.stringify(Object(d.b)({templateId:this.props.templateId,code:this.getCode(),files:this.props.files,baseURL:this.getExamplesPath()}))}),Object(f.c)("button",{className:"snack-inline-example-button",disabled:!this.state.ready},Object(f.c)(m,{size:16})," ",this.props.buttonTitle||"Try this example on Snack")))}}]),n}(u.Component);Object(l.a)(j,"contextType",h.a),Object(l.a)(j,"defaultProps",{dependencies:[]})},UlJF:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.d(t,"a",(function(){return o}))},VIvw:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("C+bE"),o=n.n(r),s=n("+Css");function a(e,t){if(t&&("object"===o()(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Object(s.a)(e)}},WqtG:function(e,t,n){"use strict";n.r(t),n.d(t,"meta",(function(){return c})),n.d(t,"headings",(function(){return p})),n.d(t,"default",(function(){return u}));var r=n("HALo"),o=n("dhJC"),s=(n("q1tI"),n("7ljp")),a=n("I0q5"),i=["components"],c={title:"Asset Caching"},p=[{depth:3,type:"text",title:"Bundling Assets"},{depth:3,type:"text",title:"Pre-loading and Caching Assets"},{depth:3,type:"text",title:"Publishing Assets"},{depth:3,type:"text",title:"Optimizing Assets"}],l={meta:c,headings:p};function u(e){var t=e.components,n=Object(o.a)(e,i);return Object(s.b)("wrapper",Object(r.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(s.b)("p",null,"This section covers all things related to loading assets in your apps, from bundling with an app binary, to caching, pre-loading and publishing."),Object(s.b)("h3",{id:"bundling-assets"},"Bundling Assets"),Object(s.b)("p",null,"Bundling assets into your binary will provide for the best user experience as your assets will be available immediately. Instead of having to make a network request to the CDN to fetch your published assets, your app will fetch them from the local disk resulting in a faster, more efficient loading experience. Bundling assets also allows offline functionality."),Object(s.b)("p",null,"To bundle assets in your binary, use the ",Object(s.b)("a",{parentName:"p",href:"/workflow/configuration/"},"assetBundlePatterns")," key in ",Object(s.b)("strong",{parentName:"p"},"app.json")," to provide a list of paths in your project directory:"),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre"},'"assetBundlePatterns": [\n  "assets/images/*"\n],\n')),Object(s.b)("p",null,"Images with paths matching the given patterns will be bundled into your native binaries next time you run ",Object(s.b)("inlineCode",{parentName:"p"},"eas build")," (or ",Object(s.b)("inlineCode",{parentName:"p"},"expo build")," if you are using the classic build service)."),Object(s.b)("blockquote",null,Object(s.b)("p",{parentName:"blockquote"},Object(s.b)("strong",{parentName:"p"},"Note"),": If your app contains an abnormal amount of assets or assets that are abnormally large in size, asset bundling may not be the best solution as it will cause your application size to bloat. If this is the case, be selective and bundle those assets that are essential and store the rest on the CDN.")),Object(s.b)("h3",{id:"pre-loading-and-caching-assets"},"Pre-loading and Caching Assets"),Object(s.b)("p",null,"Assets are cached differently depending on where they're stored and how they're used. This guide offers best practices for making sure you only download assets when you need to. In order to keep the loading screen visible while caching assets, it's also a good idea to render ",Object(s.b)("a",{parentName:"p",href:"/versions/latest/sdk/app-loading/#app-loading"},"AppLoading")," and only that component until everything is ready."),Object(s.b)("p",null,"For images that saved to the local filesytem, use ",Object(s.b)("a",{parentName:"p",href:"/versions/latest/sdk/asset/"},Object(s.b)("inlineCode",{parentName:"a"},"Asset.fromModule(image).downloadAsync()"))," to download and cache the image. There is also a ",Object(s.b)("a",{parentName:"p",href:"/versions/latest/sdk/asset/#expoassetloadasyncmodules"},"loadAsync()")," helper method to cache a batch of assets."),Object(s.b)("p",null,"For web images, use ",Object(s.b)("inlineCode",{parentName:"p"},"Image.prefetch(image)"),". Continue referencing the image normally, e.g. with ",Object(s.b)("inlineCode",{parentName:"p"},"<Image source={require('path/to/image.png')} />"),"."),Object(s.b)("p",null,"Fonts are pre-loaded using ",Object(s.b)("inlineCode",{parentName:"p"},"Font.loadAsync(font)"),". The ",Object(s.b)("inlineCode",{parentName:"p"},"font"),"\nargument in this case is an object such as the following: ",Object(s.b)("inlineCode",{parentName:"p"},"{OpenSans: require('./assets/fonts/OpenSans.ttf')}"),". ",Object(s.b)("inlineCode",{parentName:"p"},"@expo/vector-icons")," provides a helpful shortcut for this object, which you see below as ",Object(s.b)("inlineCode",{parentName:"p"},"FontAwesome.font"),"."),Object(s.b)(a.a,{label:"Pre-loading and Caching Assets",dependencies:["expo-font","expo-asset","expo-app-loading","@expo/vector-icons"],files:{"assets/images/circle.jpg":"https://snack-code-uploads.s3.us-west-1.amazonaws.com/~asset/42f59672cb9eb70368b00921c0cc60b7"},mdxType:"SnackInline"},Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-jsx"},"import * as React from 'react';\nimport { View, Text, Image } from 'react-native';\nimport AppLoading from 'expo-app-loading';\nimport * as Font from 'expo-font';\nimport { Asset } from 'expo-asset';\nimport FontAwesome from '@expo/vector-icons/FontAwesome';\n\nfunction cacheImages(images) {\n  return images.map(image => {\n    if (typeof image === 'string') {\n      return Image.prefetch(image);\n    } else {\n      return Asset.fromModule(image).downloadAsync();\n    }\n  });\n}\n\nfunction cacheFonts(fonts) {\n  return fonts.map(font => Font.loadAsync(font));\n}\n\nexport default class AppContainer extends React.Component {\n  state = {\n    isReady: false,\n  };\n\n  async _loadAssetsAsync() {\n    const imageAssets = cacheImages([\n      'https://www.google.com/images/branding/googlelogo/2x/googlelogo_color_272x92dp.png',\n      require('./assets/images/circle.jpg'),\n    ]);\n\n    const fontAssets = cacheFonts([FontAwesome.font]);\n\n    await Promise.all([...imageAssets, ...fontAssets]);\n  }\n\n  render() {\n    if (!this.state.isReady) {\n      return (\n        <AppLoading\n          startAsync={this._loadAssetsAsync}\n          onFinish={() => this.setState({ isReady: true })}\n          onError={console.warn}\n        />\n      );\n    }\n\n    return (\n      <View>\n        <Text>Hello world, this is my app.</Text>\n      </View>\n    );\n  }\n}\n"))),Object(s.b)("p",null,"See a full working example in ",Object(s.b)("a",{parentName:"p",href:"https://github.com/expo/expo/blob/sdk-43/templates/expo-template-tabs/App.tsx"},"this Expo template project"),". You can also run ",Object(s.b)("inlineCode",{parentName:"p"},"expo init --template tabs"),", which will set you up locally with the same template."),Object(s.b)("h3",{id:"publishing-assets"},"Publishing Assets"),Object(s.b)("p",null,"When you publish your project, it will upload your assets to the CDN so that they may be fetched when users run your app. However, in order for assets to be uploaded to the CDN they must be explicitly required somewhere in your application's code. Conditionally requiring assets will result in the bundler being unable to detect them and therefore they will not be uploaded when you publish your project."),Object(s.b)("h3",{id:"optimizing-assets"},"Optimizing Assets"),Object(s.b)("p",null,"You can manually optimize your assets by running the command ",Object(s.b)("inlineCode",{parentName:"p"},"npx expo-optimize")," which will use the ",Object(s.b)("a",{parentName:"p",href:"https://sharp.pixelplumbing.com/en/stable/"},"sharp")," library to compress your assets. You can set the quality of the compression by passing the ",Object(s.b)("inlineCode",{parentName:"p"},"--quality [number]")," option to the command. For example, to compress to ",Object(s.b)("inlineCode",{parentName:"p"},"90%")," you would run ",Object(s.b)("inlineCode",{parentName:"p"},"npx expo-optimize --quality 90"),"."))}u.isMDXComponent=!0},cpVT:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return r}))},iHvq:function(e,t,n){"use strict";function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.d(t,"a",(function(){return r}))},kiQV:function(e){e.exports=JSON.parse('{"name":"expo-docs","version":"44.0.0","private":true,"scripts":{"dev":"rimraf .next/preval && next dev -p 3002","build":"cross-env NODE_OPTIONS=--max-old-space-size=8192 next build","export":"yarn run build && next export && yarn run export-issue-404","export-issue-404":"echo \\"\ud83d\udee0  Patching https://github.com/vercel/next.js/issues/16528\\"; cp out/404/index.html out/404.html","export-server":"http-server out -p 8000","import-react-native-docs":"node ./scripts/import-react-native-docs.js","test-links":"node --async-stack-traces --unhandled-rejections=strict ./scripts/test-links.js","prettier":"prettier --write \'**/*.{js,ts,tsx,md}\'","lint":"tsc --noEmit && eslint .","lint-links":"remark -u validate-links ./pages","watch":"tsc --noEmit -w","test":"jest","schema-sync":"node --async-stack-traces --unhandled-rejections=strict ./scripts/schema-sync.js","remove-version":"node --unhandled-rejections=strict ./scripts/remove-version.js"},"resolutions":{"webpack":"^5.28.0"},"dependencies":{"@emotion/react":"^11.4.0","@expo/spawn-async":"^1.5.0","@expo/styleguide":"^4.0.1","@mdx-js/loader":"^1.6.22","@mdx-js/mdx":"^1.6.22","@mdx-js/react":"^1.6.22","@mdx-js/runtime":"^1.6.22","@reach/tabs":"^0.15.0","@sentry/browser":"^5.6.1","date-fns":"^2.28.0","docsearch.js":"^2.5.2","emoji-regex":"^9.2.2","front-matter":"^2.3.0","fs-extra":"^6.0.1","github-slugger":"^1.3.0","hotshot":"^1.0.5","lodash":"^4.17.20","next":"^11.1.4","nprogress":"0.2.0","path-browserify":"^1.0.1","prism-react-renderer":"1.0.2","prop-types":"15.7.2","react":"^17.0.2","react-diff-view":"^2.4.7","react-dom":"^17.0.2","react-feather":"^2.0.9","react-markdown":"^6.0.3","react-player":"^1.11.1","react-visibility-sensor":"^5.1.1","remark-gfm":"^1.0.0","tippy.js":"^6.3.1"},"devDependencies":{"@apidevtools/json-schema-ref-parser":"^9.0.9","@babel/core":"^7.13.14","@emotion/babel-preset-css-prop":"^11.2.0","@emotion/jest":"^11.7.1","@testing-library/jest-dom":"5.11.0","@testing-library/react":"10.4.3","@testing-library/react-hooks":"^7.0.2","@types/cacache":"^15.0.1","@types/fs-extra":"^9.0.11","@types/github-slugger":"^1.3.0","@types/google.analytics":"^0.0.41","@types/gtag.js":"^0.0.6","@types/lodash":"^4.14.161","@types/long":"^4.0.1","@types/mdx-js__react":"^1.5.3","@types/node":"^14.11.2","@types/nprogress":"^0.2.0","@types/react":"^17.0.11","axios":"^0.21.2","babel-plugin-module-resolver":"3.1.1","babel-plugin-preval":"^3.0.1","cross-env":"^5.2.0","danger":"^9.2.10","esbuild-loader":"^2.13.1","eslint":"^8.6.0","eslint-config-next":"^10.2.3","eslint-config-universe":"^10.0.0","eslint-plugin-lodash":"^7.3.0","http-server":"^0.12.3","jest":"^27.4.7","js-yaml":"^4.1.0","prettier":"^2.3.1","puppeteer":"^10.2.0","react-test-renderer":"^17.0.2","rehype-slug":"^4.0.1","remark-cli":"^9.0.0","remark-frontmatter":"^2.0.0","remark-validate-links":"^10.0.4","rimraf":"^3.0.2","semver":"^7.3.5","sitemap":"^6.3.0","typescript":"^4.5.4","unist-builder":"^2.0.0","unist-util-visit":"^2.0.3"}}')},ufKf:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r="https://snack.expo.dev";function o(e){var t=e.templateId,n=e.code,r=e.files,o=e.baseURL,s={};return r&&Object.keys(r).forEach((function(e){var t=r[e],n=/\.(jsx?|tsx?|json|md)$/i.test(e);s[e]=n?{type:"CODE",url:t.match(/^https?:\/\//)?t:"".concat(o,"/").concat(t)}:{type:"ASSET",contents:t}})),t?s["App.js"]={type:"CODE",url:"".concat(o,"/").concat(t,".js")}:n&&(s["App.js"]={type:"CODE",contents:n}),s}},z7pX:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("6FTQ");var o=n("8rE2");function s(e){return function(e){if(Array.isArray(e))return Object(r.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Object(o.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}},[["1jzr",1,0,2,3]]]);