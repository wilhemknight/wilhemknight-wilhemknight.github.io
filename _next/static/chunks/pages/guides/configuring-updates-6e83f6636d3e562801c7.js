_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[140],{"7ljp":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return h}));var a=n("q1tI"),o=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=o.a.createContext({}),u=function(e){var t=o.a.useContext(s),n=t;return e&&(n="function"===typeof e?e(t):p(p({},t),e)),n},c=function(e){var t=u(e.components);return o.a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},b=o.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,i=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),c=u(n),b=a,h=c["".concat(i,".").concat(b)]||c[b]||d[b]||r;return n?o.a.createElement(h,p(p({ref:t},s),{},{components:n})):o.a.createElement(h,p({ref:t},s))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"===typeof e||a){var r=n.length,i=new Array(r);i[0]=b;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p.mdxType="string"===typeof e?e:a,i[1]=p;for(var s=2;s<r;s++)i[s]=n[s];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"},HALo:function(e,t,n){"use strict";function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}n.d(t,"a",(function(){return a}))},Qetd:function(e,t,n){"use strict";var a=Object.assign.bind(Object);e.exports=a,e.exports.default=e.exports},UoMR:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/guides/configuring-updates",function(){return n("fUYk")}])},dhJC:function(e,t,n){"use strict";function a(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}n.d(t,"a",(function(){return a}))},fUYk:function(e,t,n){"use strict";n.r(t),n.d(t,"meta",(function(){return p})),n.d(t,"headings",(function(){return l})),n.d(t,"default",(function(){return u}));var a=n("HALo"),o=n("dhJC"),r=(n("q1tI"),n("7ljp")),i=["components"],p={title:"Configuring Updates"},l=[{depth:2,type:"text",title:"Automatic Updates"},{depth:2,type:"text",title:"Manual Updates"},{depth:2,type:"text",title:"Disabling Updates"}],s={meta:p,headings:l};function u(e){var t=e.components,n=Object(o.a)(e,i);return Object(r.b)("wrapper",Object(a.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},"This guide is four our Classic Updates service. As of Dec 2021, we started previewing the next generation of our updates service: EAS Update. ",Object(r.b)("a",{parentName:"p",href:"/../../../../../../eas-update"},"Learn more"),".")),Object(r.b)("p",null,"Expo provides various settings to configure how your app receives updates. Updates allow you to publish a new version of your app JavaScript and assets without building a new version of your app and re-submitting to app stores. (",Object(r.b)("a",{parentName:"p",href:"/workflow/publishing/"},"Read more about the limitations"),")."),Object(r.b)("p",null,"To create an update of your app, run ",Object(r.b)("inlineCode",{parentName:"p"},"expo publish"),". If you're using release channels, specify one with ",Object(r.b)("inlineCode",{parentName:"p"},"--release-channel <channel-name>")," option. ",Object(r.b)("strong",{parentName:"p"},"Please note"),"- if you wish to update the SDK version of your app, or make ",Object(r.b)("a",{parentName:"p",href:"/workflow/publishing/#some-native-configuration-cant-be-updated-by"},"any of the these changes"),", you'll need to rebuild your app with ",Object(r.b)("inlineCode",{parentName:"p"},"eas build")," (or ",Object(r.b)("inlineCode",{parentName:"p"},"expo build")," if you are using the classic build service) and upload the binary file to the appropriate app store (",Object(r.b)("a",{parentName:"p",href:"/../../../../../../build/setup/"},"see the docs here"),")."),Object(r.b)("p",null,"Updates are controlled by the ",Object(r.b)("a",{parentName:"p",href:"/workflow/configuration/#updates"},Object(r.b)("inlineCode",{parentName:"a"},"updates")," settings in app.json"),", which handle the initial app load, and the ",Object(r.b)("a",{parentName:"p",href:"/versions/latest/sdk/updates/"},"Updates SDK module"),", which allows you to fetch updates asynchronously from your JS."),Object(r.b)("h2",{id:"automatic-updates"},"Automatic Updates"),Object(r.b)("p",null,"If your ",Object(r.b)("strong",{parentName:"p"},"app.json")," does not contain an ",Object(r.b)("inlineCode",{parentName:"p"},"updates.fallbackToCacheTimeout")," field it will default to ",Object(r.b)("inlineCode",{parentName:"p"},"0")," and ",Object(r.b)("inlineCode",{parentName:"p"},"expo-updates")," will attempt to start your app immediately with a cached bundle while downloading a newer one in the background for future use. When using this configuration, users that download the app from a store and launch it for the first time will always see the version of the app that the binary was built against. ",Object(r.b)("a",{parentName:"p",href:"/versions/latest/sdk/updates/#expoupdatesaddlistenereventlistener"},Object(r.b)("inlineCode",{parentName:"a"},"Updates.addListener"))," provides a hook to let you respond when the new bundle is finished downloading. You can use this to notify users that they should restart the app, and you can also restart it programmatically with ",Object(r.b)("a",{parentName:"p",href:"/versions/latest/sdk/updates/#updatesreloadasync"},Object(r.b)("inlineCode",{parentName:"a"},"Updates.reloadAsync()")),", eg: in response to a prompt to the user."),Object(r.b)("p",null,"You can also set a nonzero timeout, in which case Expo will attempt to download a new update before launching the app. If there is no network connection available, or it has not finished downloading in the allotted time, Expo will fall back to loading a cached version of your app, and continue trying to fetch the update in the background (at which point it will be saved into the cache for the next app load). We strongly advise against blocking app loading on fetching an update because it can leave users with the perception that the app is not working if it takes a while to download the update, and every launch will be slower because a network request has to be made to check for an update before proceeding to the app."),Object(r.b)("p",null,"In Expo Go, the latest published bundle of your app will always be launched (unless the request times out or network connection is unavailable), regardless of the ",Object(r.b)("inlineCode",{parentName:"p"},"updates")," settings in your app config."),Object(r.b)("h2",{id:"manual-updates"},"Manual Updates"),Object(r.b)("p",null,"In standalone apps, it is also possible to turn off automatic updates, and to instead control updates entirely within your JS code. This is desirable if you want some custom logic around fetching updates (e.g. only over Wi-Fi)."),Object(r.b)("p",null,"Setting ",Object(r.b)("inlineCode",{parentName:"p"},"updates.checkAutomatically")," to ",Object(r.b)("inlineCode",{parentName:"p"},'"ON_ERROR_RECOVERY"')," in app.json will prevent Expo from automatically fetching the latest update every time your app is launched. Only the most recent cached version of your bundle will be loaded. It will only automatically fetch an update if the last run of the cached bundle produced a fatal JS error."),Object(r.b)("p",null,"You can then use the ",Object(r.b)("a",{parentName:"p",href:"/versions/latest/sdk/updates/"},Object(r.b)("inlineCode",{parentName:"a"},"expo-updates"))," module to download new updates and, if appropriate, notify the user to reload their app."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-javascript"},"import * as Updates from 'expo-updates';\n\ntry {\n  const update = await Updates.checkForUpdateAsync();\n  if (update.isAvailable) {\n    await Updates.fetchUpdateAsync();\n    // ... notify user of update ...\n    await Updates.reloadAsync();\n  }\n} catch (e) {\n  // handle or log error\n}\n")),Object(r.b)("p",null,"Checking for an update uses a device's bandwidth and battery life like any network call. Additionally, updates served by Expo may be rate limited. A good rule of thumb to check for updates judiciously is to use check when the user launches or foregrounds the app. Avoid polling for updates in a frequent loop."),Object(r.b)("p",null,"Note that ",Object(r.b)("inlineCode",{parentName:"p"},'checkAutomatically: "ON_ERROR_RECOVERY"')," will be ignored in Expo Go, although the imperative Updates methods will still function normally."),Object(r.b)("h2",{id:"disabling-updates"},"Disabling Updates"),Object(r.b)("p",null,"It is possible to entirely disable updates in an app, by setting ",Object(r.b)("inlineCode",{parentName:"p"},"updates.enabled")," to ",Object(r.b)("inlineCode",{parentName:"p"},"false")," in ",Object(r.b)("strong",{parentName:"p"},"app.json"),". This will ignore all code paths that fetch app bundles from Expo's servers. In this case, all updates to your app will need to be routed through the iOS App Store and/or Google Play Store."),Object(r.b)("p",null,"This setting is ignored in the Expo Go app."))}u.isMDXComponent=!0}},[["UoMR",1,0]]]);