_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[76],{"+Css":function(e,n,t){"use strict";function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}t.d(n,"a",(function(){return o}))},"7LId":function(e,n,t){"use strict";function o(e,n){return(o=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}function r(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&o(e,n)}t.d(n,"a",(function(){return r}))},"7ljp":function(e,n,t){"use strict";t.d(n,"a",(function(){return s})),t.d(n,"b",(function(){return f}));var o=t("q1tI"),r=t.n(o);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var u=r.a.createContext({}),p=function(e){var n=r.a.useContext(u),t=n;return e&&(t="function"===typeof e?e(n):l(l({},n),e)),t},s=function(e){var n=p(e.components);return r.a.createElement(u.Provider,{value:n},e.children)},b={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},d=r.a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,i=e.originalType,a=e.parentName,u=c(e,["components","mdxType","originalType","parentName"]),s=p(t),d=o,f=s["".concat(a,".").concat(d)]||s[d]||b[d]||i;return t?r.a.createElement(f,l(l({ref:n},u),{},{components:t})):r.a.createElement(f,l({ref:n},u))}));function f(e,n){var t=arguments,o=n&&n.mdxType;if("string"===typeof e||o){var i=t.length,a=new Array(i);a[0]=d;var l={};for(var c in n)hasOwnProperty.call(n,c)&&(l[c]=n[c]);l.originalType=e,l.mdxType="string"===typeof e?e:o,a[1]=l;for(var u=2;u<i;u++)a[u]=t[u];return r.a.createElement.apply(null,a)}return r.a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},"C+bE":function(e,n){function t(n){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?(e.exports=t=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=t=function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),t(n)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0},"H+61":function(e,n,t){"use strict";function o(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}t.d(n,"a",(function(){return o}))},JUjw:function(e,n,t){"use strict";t.r(n),t.d(n,"meta",(function(){return c})),t.d(n,"headings",(function(){return u})),t.d(n,"default",(function(){return s}));var o=t("HALo"),r=t("dhJC"),i=(t("q1tI"),t("7ljp")),a=t("3WCi"),l=["components"],c={title:"Triggering builds from CI"},u=[{depth:2,type:"text",title:"Prerequisites"},{depth:3,type:"text",title:"Run a successful build from your local machine"},{depth:2,type:"text",title:"Configure your app for CI"},{depth:3,type:"text",title:"Provide a personal access token to authenticate with your Expo account on CI"},{depth:3,type:"text",title:"(Optional) Provide an ASC Api Token for your Apple Team"},{depth:3,type:"text",title:"Trigger new builds"}],p={meta:c,headings:u};function s(e){var n=e.components,t=Object(r.a)(e,l);return Object(i.b)("wrapper",Object(o.a)({},p,t,{components:n,mdxType:"MDXLayout"}),Object(i.b)("p",null,"This document outlines how to trigger builds on EAS for your app from a CI environment such as GitHub Actions."),Object(i.b)("p",null,"Before building with EAS on CI, we need to install and configure ",Object(i.b)("inlineCode",{parentName:"p"},"eas-cli"),". Then, we can trigger new builds with the ",Object(i.b)("inlineCode",{parentName:"p"},"eas build")," command."),Object(i.b)("h2",{id:"prerequisites"},"Prerequisites"),Object(i.b)("h3",{id:"run-a-successful-build-from-your-local-machine"},"Run a successful build from your local machine"),Object(i.b)("p",null,"To trigger EAS builds from a CI environment, we first need to configure our app for EAS Build and successfully run a build from our local machine for each platform that we'd like to support on CI."),Object(i.b)("p",null,"If you have run ",Object(i.b)("inlineCode",{parentName:"p"},"eas build -p [all|ios|android]")," successfully before, then you can continue."),Object(i.b)("p",null,"If you haven't done this yet, please refer to the ",Object(i.b)("a",{parentName:"p",href:"/build/setup/"},"Creating your first build")," guide and return here when you're ready."),Object(i.b)("details",null,Object(i.b)("summary",null,Object(i.b)("strong",null,"Are you using the classic build system?")," (",Object(i.b)(a.b,{mdxType:"InlineCode"},"expo build:[android|ios]"),")")," ",Object(i.b)("p",null,Object(i.b)("p",null,"Learn how to ",Object(i.b)("a",{parentName:"p",href:"/../../../../../../classic/turtle-cli/"},"build standalone apps on your CI with our classic build service"),"."))),Object(i.b)("h2",{id:"configure-your-app-for-ci"},"Configure your app for CI"),Object(i.b)("h3",{id:"provide-a-personal-access-token-to-authenticate-with-your-expo-account-on-ci"},"Provide a personal access token to authenticate with your Expo account on CI"),Object(i.b)("p",null,"Next, we need to ensure that we can authenticate ourselves on CI as the owner of the app. This is possible by storing a personal access token in the ",Object(i.b)("inlineCode",{parentName:"p"},"EXPO_TOKEN")," environment variable in the CI settings."),Object(i.b)("p",null,"See ",Object(i.b)("a",{parentName:"p",href:"/../../../../../../accounts/programmatic-access/#personal-account-personal-access-tokens"},"the guide for personal access tokens")," to learn how to create access tokens."),Object(i.b)("h3",{id:"optional-provide-an-asc-api-token-for-your-apple-team"},"(Optional) Provide an ASC Api Token for your Apple Team"),Object(i.b)("p",null,"In the event your iOS credentials need to be repaired, we will need an ASC API key to authenticate ourselves to Apple in CI. A common case is when your provisioning profile needs to be re-signed."),Object(i.b)("p",null,"You will need to create an ",Object(i.b)("a",{parentName:"p",href:"https://expo.fyi/creating-asc-api-key"},"API Key"),". Next, you will need to gather information about your ",Object(i.b)("a",{parentName:"p",href:"https://expo.fyi/apple-team"},"Apple Team"),". "),Object(i.b)("p",null,"Using the information you've gathered, pass it into the build command through environment variables. You will need to pass in the following:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"EXPO_ASC_API_KEY_PATH"),": the path to your ASC API Key .p8 file, e.g. /path/to/key/AuthKey_SFB993FB5F.p8"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"EXPO_ASC_KEY_ID"),": the key ID of your ASC API Key, e.g. SFB993FB5F."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"EXPO_ASC_ISSUER_ID"),": the issuer ID of your ASC API Key, e.g. f9675cff-f45d-4116-bd2c-2372142cee09."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"EXPO_APPLE_TEAM_ID"),": your Apple Team ID, e.g. 77KQ969CHE."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"EXPO_APPLE_TEAM_TYPE"),": your Apple Team Type. Valid types are ",Object(i.b)("inlineCode",{parentName:"li"},"IN_HOUSE"),", ",Object(i.b)("inlineCode",{parentName:"li"},"COMPANY_OR_ORGANIZATION"),", or ",Object(i.b)("inlineCode",{parentName:"li"},"INDIVIDUAL"),". ")),Object(i.b)("h3",{id:"trigger-new-builds"},"Trigger new builds"),Object(i.b)("p",null,"Now that we're authenticated with Expo CLI, we can create the build step."),Object(i.b)("p",null,"To trigger new builds, we will add this script to our configuration:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-sh"},"npx eas-cli build --platform all --non-interactive\n")),Object(i.b)("p",null,"This will trigger a new build on EAS and print the URLs for the built files after the build completes."),Object(i.b)("details",null,Object(i.b)("summary",null,"Travis CI"),Object(i.b)("p",null,Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-yaml"},"---\nlanguage: node_js\nnode_js:\n  - node\n  - lts/*\ncache:\n  directories:\n    - ~/.npm\nbefore_script:\n  - npm install -g npm@latest\n\njobs:\n  include:\n    - stage: build\n      node_js: lts/*\n      script:\n        - npm ci\n        - npx eas-cli build --platform all --non-interactive\n")),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"Put this into ",Object(i.b)("inlineCode",{parentName:"p"},".travis.yml")," in the root of your repository.")))),Object(i.b)("details",null,Object(i.b)("summary",null,"GitLab CI"),Object(i.b)("p",null,Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-yaml"},"image: node:alpine\n\ncache:\n  key: ${CI_COMMIT_REF_SLUG}\n  paths:\n    - ~/.npm\n\nstages:\n  - build\n\nbefore_script:\n  - npm ci\n\neas-build:\n  stage: build\n  script:\n    - apk add --no-cache bash\n    - npx eas-cli build --platform all --non-interactive\n")),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"Put this into ",Object(i.b)("inlineCode",{parentName:"p"},".gitlab-ci.yml")," in the root of your repository.")))),Object(i.b)("details",null,Object(i.b)("summary",null,"Bitbucket Pipelines"),Object(i.b)("p",null,Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-yaml"},"image: node:alpine\n\ndefinitions:\n  caches:\n    npm: ~/.npm\n\npipelines:\n  default:\n    - step:\n        name: Build app\n        deployment: test\n        caches:\n          - npm\n        script:\n          - apk add --no-cache bash\n          - npm ci\n          - npx eas-cli build --platform all --non-interactive\n")),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"Put this into ",Object(i.b)("inlineCode",{parentName:"p"},"bitbucket-pipelines.yml")," in the root of your repository.")))),Object(i.b)("details",null,Object(i.b)("summary",null,"CircleCI"),Object(i.b)("p",null,Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-yaml"},"version: 2.1\n\nexecutors:\n  default:\n    docker:\n      - image: cimg/node:lts\n    working_directory: ~/my-app\n\njobs:\n  eas_build:\n    executor: default\n    steps:\n      - checkout\n      - run:\n          name: Install dependencies\n          command: npm ci\n      - run:\n          name: Trigger build\n          command: npx eas-cli build --platform all --non-interactive\n\nworkflows:\n  build_app:\n    jobs:\n      - eas_build:\n          filters:\n            branches:\n              only: master\n")),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"Put this into ",Object(i.b)("inlineCode",{parentName:"p"},".circleci/config.yml")," in the root of your repository.")))),Object(i.b)("details",null,Object(i.b)("summary",null,"GitHub Actions"),Object(i.b)("p",null,Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-yaml"},"name: EAS Build\non:\n  workflow_dispatch:\n  push:\n    branches:\n      - master\njobs:\n  build:\n    name: Install and build\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v2\n      - uses: actions/setup-node@v2\n        with:\n          node-version: 16.x\n          cache: npm\n      - name: Setup Expo and EAS\n        uses: expo/expo-github-action@v7\n        with:\n          expo-version: 5.x\n          eas-version: latest\n          token: ${{ secrets.EXPO_TOKEN }}\n      - name: Install dependencies\n        run: npm ci\n      - name: Build on EAS\n        run: eas build --platform all --non-interactive\n")),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"Put this into ",Object(i.b)("inlineCode",{parentName:"p"},".github/workflows/eas-build.yml")," in the root of your repository.")))))}s.isMDXComponent=!0},LYa9:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/build/building-on-ci",function(){return t("JUjw")}])},UlJF:function(e,n,t){"use strict";function o(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(e,n,t){return n&&o(e.prototype,n),t&&o(e,t),e}t.d(n,"a",(function(){return r}))},VIvw:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var o=t("C+bE"),r=t.n(o),i=t("+Css");function a(e,n){if(n&&("object"===r()(n)||"function"===typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return Object(i.a)(e)}},iHvq:function(e,n,t){"use strict";function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}t.d(n,"a",(function(){return o}))}},[["LYa9",1,0,2,3,7]]]);