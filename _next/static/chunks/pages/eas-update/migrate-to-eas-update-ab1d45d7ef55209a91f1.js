_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[120],{"7ljp":function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return m}));var a=n("q1tI"),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=r.a.createContext({}),b=function(e){var t=r.a.useContext(c),n=t;return e&&(n="function"===typeof e?e(t):p(p({},t),e)),n},s=function(e){var t=b(e.components);return r.a.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),s=b(n),d=a,m=s["".concat(o,".").concat(d)]||s[d]||u[d]||i;return n?r.a.createElement(m,p(p({ref:t},c),{},{components:n})):r.a.createElement(m,p({ref:t},c))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"===typeof e||a){var i=n.length,o=new Array(i);o[0]=d;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p.mdxType="string"===typeof e?e:a,o[1]=p;for(var c=2;c<i;c++)o[c]=n[c];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},KiYJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n("cpVT"),r=n("3zh3"),i=(n("q1tI"),n("AeFk"));function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e){var t=e.alt,n=e.src,a=e.style,o=e.containerStyle;return Object(i.c)("div",{style:p({textAlign:"center",backgroundColor:r.theme.background.secondary,paddingTop:10,paddingBottom:10,marginTop:20,marginBottom:20},o)},Object(i.c)("img",{src:n,alt:t,style:a}))}},YeFz:function(e,t,n){"use strict";n.r(t),n.d(t,"meta",(function(){return l})),n.d(t,"headings",(function(){return c})),n.d(t,"default",(function(){return s}));var a=n("HALo"),r=n("dhJC"),i=(n("q1tI"),n("7ljp")),o=n("KiYJ"),p=["components"],l={title:"Migrating from Classic Updates to EAS Update"},c=[{depth:2,type:"text",title:"Prerequisites"},{depth:2,type:"text",title:"Install Expo CLI and EAS CLI"},{depth:2,type:"text",title:"Configure your project"},{depth:2,type:"text",title:"Create new builds"},{depth:2,type:"text",title:"Developing locally"},{depth:2,type:"text",title:"Publishing an update"},{depth:2,type:"text",title:"Additional possible migration steps"},{depth:2,type:"text",title:"Known issues"},{depth:2,type:"text",title:"Next steps"}],b={meta:l,headings:c};function s(e){var t=e.components,n=Object(r.a)(e,p);return Object(i.b)("wrapper",Object(a.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"EAS Update is the next generation of Expo's updates service. If you're using Classic Updates, this guide will help you upgrade to EAS Update."),Object(i.b)("h2",{id:"prerequisites"},"Prerequisites"),Object(i.b)("p",null,"EAS Update requires the following versions or greater:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Expo CLI 5.0.0"),Object(i.b)("li",{parentName:"ul"},"EAS CLI 0.41.1"),Object(i.b)("li",{parentName:"ul"},"Expo SDK 44.0.1"),Object(i.b)("li",{parentName:"ul"},"expo-updates 0.11.2")),Object(i.b)("h2",{id:"install-expo-cli-and-eas-cli"},"Install Expo CLI and EAS CLI"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Install EAS and Expo CLIs with:"),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",{parentName:"pre",className:"language-bash"},"npm install --global eas-cli expo-cli\n"))),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Then, log in with your expo account:"),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",{parentName:"pre",className:"language-bash"},"eas login\n")))),Object(i.b)("h2",{id:"configure-your-project"},"Configure your project"),Object(i.b)("p",null,"You'll need to make the following changes to your project:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Install the latest ",Object(i.b)("inlineCode",{parentName:"p"},"expo-updates")," library with:"),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",{parentName:"pre",className:"language-bash"},"yarn add expo-updates@0.11.2\n"))),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Initialize your project with EAS Update:"),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",{parentName:"pre",className:"language-bash"},"eas update:configure\n")),Object(i.b)("p",{parentName:"li"},"After this command, you should have two a new fields in your app config (",Object(i.b)("strong",{parentName:"p"},"app.json"),"/",Object(i.b)("strong",{parentName:"p"},"app.config.js"),") at ",Object(i.b)("inlineCode",{parentName:"p"},"expo.updates.url")," and ",Object(i.b)("inlineCode",{parentName:"p"},"expo.runtimeVersion"),".")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"To ensure that updates are compatible with the underlying native code inside a build, EAS Update uses a new field named ",Object(i.b)("inlineCode",{parentName:"p"},"runtimeVersion")," that replaces the ",Object(i.b)("inlineCode",{parentName:"p"},"sdkVersion")," field in your project's app config (",Object(i.b)("strong",{parentName:"p"},"app.json"),"/",Object(i.b)("strong",{parentName:"p"},"app.config.js"),"). Remove the ",Object(i.b)("inlineCode",{parentName:"p"},"expo.sdkVersion")," property from your app config.")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Next, set your project up with EAS Build by running:"),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",{parentName:"pre",className:"language-bash"},"eas build:configure\n"))),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"To allow updates to apply to builds built with EAS, update your EAS build profiles in ",Object(i.b)("strong",{parentName:"p"},"eas.json")," to include channel properties. These channels should replace any ",Object(i.b)("inlineCode",{parentName:"p"},"releaseChannel")," properties. We find it convenient to name the ",Object(i.b)("inlineCode",{parentName:"p"},"channel")," after the profile's name. For instance, the ",Object(i.b)("inlineCode",{parentName:"p"},"preview")," profile has a ",Object(i.b)("inlineCode",{parentName:"p"},"channel")," named ",Object(i.b)("inlineCode",{parentName:"p"},'"preview"')," and the ",Object(i.b)("inlineCode",{parentName:"p"},"production")," profile has a ",Object(i.b)("inlineCode",{parentName:"p"},"channel")," named ",Object(i.b)("inlineCode",{parentName:"p"},'"production"'),"."))),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-json"},'{\n  "build": {\n    "development": {\n      "developmentClient": true,\n      "distribution": "internal"\n    },\n    "preview": {\n      "distribution": "internal",\n      "channel": "preview"\n    },\n    "production": {\n      "channel": "production"\n    }\n  }\n}\n')),Object(i.b)("ol",{start:6},Object(i.b)("li",{parentName:"ol"},"Optional: If your project is a bare React Native project, ",Object(i.b)("a",{parentName:"li",href:"/../../../../../../eas-update/bare-react-native"},"read the doc")," on extra configuration you may need.")),Object(i.b)("h2",{id:"create-new-builds"},"Create new builds"),Object(i.b)("p",null,"The changes above affect the native code layer inside builds, which means we'll need to make new builds. Once your builds are complete, we'll be ready to develop an update and publish it."),Object(i.b)("h2",{id:"developing-locally"},"Developing locally"),Object(i.b)("p",null,"EAS Update uses a ",Object(i.b)("a",{parentName:"p",href:"/../../../../../../technical-specs/expo-updates-0"},"modern manifest format"),". When you have a EAS Update url in your app config at ",Object(i.b)("inlineCode",{parentName:"p"},"updates.url"),", Expo CLI will automatically serve the correct manifest format for your project. This will ensure that the code you develop locally will work as an update when published later. You can start a locally development session just like before, with:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-bash"},"yarn start\n\n# or\n\nexpo start\n")),Object(i.b)("h2",{id:"publishing-an-update"},"Publishing an update"),Object(i.b)("p",null,"To publish an update, run:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-bash"},'eas update --branch [branch-name] --message [message]\n\n# example\neas update --branch production --message "Fixes typo"\n')),Object(i.b)("p",null,'EAS Update adds a new type of object called a "branch". A branch is a list of updates, and it is linked to a channel. In the diagram below, builds with a channel of "production" are linked to a branch named "production". By default, channels and branches of the same name are linked until changed.'),Object(i.b)(o.a,{alt:'Channel "production" linked to branch "production"',src:"/static/images/eas-update/channel-branch.png",mdxType:"ImageSpotlight"}),Object(i.b)("h2",{id:"additional-possible-migration-steps"},"Additional possible migration steps"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"If you have any scripts that run ",Object(i.b)("inlineCode",{parentName:"li"},"expo publish"),", you can replace those with ",Object(i.b)("inlineCode",{parentName:"li"},"eas update"),". You can view all the options for publishing with ",Object(i.b)("inlineCode",{parentName:"li"},"eas update --help")),Object(i.b)("li",{parentName:"ul"},"If you have any code that references ",Object(i.b)("inlineCode",{parentName:"li"},"Updates.releaseChannel")," from the ",Object(i.b)("inlineCode",{parentName:"li"},"expo-updates")," library, you'll have to remove those. Currently, EAS Update does not expose the ",Object(i.b)("inlineCode",{parentName:"li"},"channel")," of a build. Instead, you can use ",Object(i.b)("a",{parentName:"li",href:"/../../../../../../build-reference/variables"},"environment variables"),"."),Object(i.b)("li",{parentName:"ul"},"Remove any code that references ",Object(i.b)("inlineCode",{parentName:"li"},"Constants.manifest"),". That will now always return ",Object(i.b)("inlineCode",{parentName:"li"},"null"),".")),Object(i.b)("h2",{id:"known-issues"},"Known issues"),Object(i.b)("p",null,'EAS Update is currently in "preview", meaning that we may make major changes to developer-facing workflows. There are also a variety of ',Object(i.b)("a",{parentName:"p",href:"/../../../../../../eas-update/known-issues"},"known issues"),", which you should consider before using EAS Update with your project."),Object(i.b)("h2",{id:"next-steps"},"Next steps"),Object(i.b)("p",null,"EAS Update is built to be faster and more powerful than ever before. We can't wait to hear what you think. Try setting up EAS Update to publish on pushing to GitHub with a ",Object(i.b)("a",{parentName:"p",href:"/../../../../../../eas-update/github-actions"},"GitHub Action"),". Also check out the new sets of ",Object(i.b)("a",{parentName:"p",href:"/../../../../../../eas-update/deployment-patterns"},"deployment patterns")," enabled by EAS Update."),Object(i.b)("p",null,"If you run into issues or have feedback, join us on ",Object(i.b)("a",{parentName:"p",href:"https://chat.expo.dev/"},"Discord")," in the #eas channel."))}s.isMDXComponent=!0},cpVT:function(e,t,n){"use strict";function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return a}))},wT0D:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/eas-update/migrate-to-eas-update",function(){return n("YeFz")}])}},[["wT0D",1,0,2,3]]]);