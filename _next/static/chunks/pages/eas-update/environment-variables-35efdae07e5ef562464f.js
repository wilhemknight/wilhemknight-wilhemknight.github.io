_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[112],{"7ljp":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return m}));var a=n("q1tI"),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var b=r.a.createContext({}),s=function(e){var t=r.a.useContext(b),n=t;return e&&(n="function"===typeof e?e(t):p(p({},t),e)),n},c=function(e){var t=s(e.components);return r.a.createElement(b.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,b=l(e,["components","mdxType","originalType","parentName"]),c=s(n),d=a,m=c["".concat(o,".").concat(d)]||c[d]||u[d]||i;return n?r.a.createElement(m,p(p({ref:t},b),{},{components:n})):r.a.createElement(m,p({ref:t},b))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"===typeof e||a){var i=n.length,o=new Array(i);o[0]=d;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p.mdxType="string"===typeof e?e:a,o[1]=p;for(var b=2;b<i;b++)o[b]=n[b];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},HALo:function(e,t,n){"use strict";function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}n.d(t,"a",(function(){return a}))},Qetd:function(e,t,n){"use strict";var a=Object.assign.bind(Object);e.exports=a,e.exports.default=e.exports},dhJC:function(e,t,n){"use strict";function a(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}n.d(t,"a",(function(){return a}))},f39v:function(e,t,n){"use strict";n.r(t),n.d(t,"meta",(function(){return p})),n.d(t,"headings",(function(){return l})),n.d(t,"default",(function(){return s}));var a=n("HALo"),r=n("dhJC"),i=(n("q1tI"),n("7ljp")),o=["components"],p={title:"Using environment variables with EAS Update"},l=[{depth:2,type:"text",title:"Setting up the app config"},{depth:2,type:"text",title:"Setting and getting environment variables during development"},{depth:2,type:"text",title:"Setting and getting environment variables when building"},{depth:2,type:"text",title:"Setting and getting environment variables when publishing an update"},{depth:2,type:"text",title:"Creating an Env.ts file to get environment variables"}],b={meta:p,headings:l};function s(e){var t=e.components,n=Object(r.a)(e,o);return Object(i.b)("wrapper",Object(a.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"\u26a0\ufe0f The APIs below are not stable and are expected to change as we develop EAS Update. An alternate solution is to use a babel plugin to transform variables into environment variables, as described ",Object(i.b)("a",{parentName:"p",href:"/../../../../../../guides/environment-variables/#using-babel-to-replace-variables"},"here"),".")),Object(i.b)("p",null,"EAS Build and EAS Update allow setting and getting environment variables at different times. There are multiple steps to ensure the proper environment variables are available when developing, building, and publishing an update to a project."),Object(i.b)("h2",{id:"setting-up-the-app-config"},"Setting up the app config"),Object(i.b)("p",null,"To expose environment variables in our project, we'll have to set up our app config to allow it. After this, we'll be able to access these variables throughout our entire project."),Object(i.b)("p",null,"First, we'll need to rename ",Object(i.b)("strong",{parentName:"p"},"app.json")," to ",Object(i.b)("strong",{parentName:"p"},"app.config.js"),", which will allow us to export our app's config, including JavaScript variables."),Object(i.b)("p",null,"Next, we'll add an ",Object(i.b)("inlineCode",{parentName:"p"},"API_URL")," environment variable to our project."),Object(i.b)("p",null,"To add it to our app config, we'll add it under the ",Object(i.b)("inlineCode",{parentName:"p"},"extra.eas")," property."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"app.config.js")),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js"},"export default () => ({\n  expo: {\n    extra: {\n      eas: {\n        API_URL: process.env.API_URL || null,\n      },\n    },\n    // ...\n  },\n});\n")),Object(i.b)("p",null,"The code above sets the ",Object(i.b)("inlineCode",{parentName:"p"},"extra.eas")," property. Now, we need to set and get the variable in our project."),Object(i.b)("h2",{id:"setting-and-getting-environment-variables-during-development"},"Setting and getting environment variables during development"),Object(i.b)("p",null,"To set the ",Object(i.b)("inlineCode",{parentName:"p"},"API_URL")," environment variable during development, we can prepend the variables before running ",Object(i.b)("inlineCode",{parentName:"p"},"expo start")," like this:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-bash"},'API_URL="http://localhost:3000" expo start\n')),Object(i.b)("p",null,"The command above will set the ",Object(i.b)("inlineCode",{parentName:"p"},"API_URL")," to ",Object(i.b)("inlineCode",{parentName:"p"},'"http://localhost:3000"'),". Now, it's time to access that value inside our project."),Object(i.b)("p",null,"To access it, we can use the ",Object(i.b)("inlineCode",{parentName:"p"},"expo-constants")," library. It's located under the ",Object(i.b)("inlineCode",{parentName:"p"},"Constants.manifest2?.extra?.expoClient?.extra?.eas?.API_URL")," property."),Object(i.b)("h2",{id:"setting-and-getting-environment-variables-when-building"},"Setting and getting environment variables when building"),Object(i.b)("p",null,"To set the ",Object(i.b)("inlineCode",{parentName:"p"},"API_URL")," environment variable during a build, we can include an ",Object(i.b)("inlineCode",{parentName:"p"},'"env"')," property in an ",Object(i.b)("strong",{parentName:"p"},"eas.json")," build profile, like below:"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"eas.json"),":"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-json"},'{\n  "production": {\n    "env": {\n      "API_URL": "https://prod.example.com"\n    }\n  },\n  "staging": {\n    "env": {\n      "API_URL": "https://staging.example.com"\n    }\n  }\n}\n')),Object(i.b)("p",null,"Once we run a command like ",Object(i.b)("inlineCode",{parentName:"p"},"eas build --profile production"),", the ",Object(i.b)("inlineCode",{parentName:"p"},'"env"'),' property in the "production" build profile will set the ',Object(i.b)("inlineCode",{parentName:"p"},"API_URL")," to ",Object(i.b)("inlineCode",{parentName:"p"},"https://prod.example.com/")," inside the build."),Object(i.b)("p",null,"To access it, we can use the ",Object(i.b)("inlineCode",{parentName:"p"},"expo-constants")," library. It's located under the ",Object(i.b)("inlineCode",{parentName:"p"},"Constants.manifest?.extra?.eas?.API_URL")," property."),Object(i.b)("h2",{id:"setting-and-getting-environment-variables-when-publishing-an-update"},"Setting and getting environment variables when publishing an update"),Object(i.b)("p",null,"To set the ",Object(i.b)("inlineCode",{parentName:"p"},"API_URL")," environment variable when publishing an update, we can prepend the environment variables before running ",Object(i.b)("inlineCode",{parentName:"p"},"eas update")," like this:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-bash"},'API_URL="https://prod.example.com" eas update --branch production\n')),Object(i.b)("p",null,"When EAS CLI creates the update, it will set the ",Object(i.b)("inlineCode",{parentName:"p"},"API_URL")," to ",Object(i.b)("inlineCode",{parentName:"p"},"https://prod.example.com")," inside the update's bundle."),Object(i.b)("p",null,"To access it, we can use the ",Object(i.b)("inlineCode",{parentName:"p"},"expo-constants")," library. It's located under the ",Object(i.b)("inlineCode",{parentName:"p"},"Constants.manifest2?.extra?.expoClient?.extra?.eas?.API_URL")," property."),Object(i.b)("p",null,"Note: we could also use the ",Object(i.b)("inlineCode",{parentName:"p"},"expo-updates")," library to access ",Object(i.b)("inlineCode",{parentName:"p"},"API_URL"),". It is under ",Object(i.b)("inlineCode",{parentName:"p"},"Updates.manifest?.extra?.expoClient?.extra?.eas?.API_URL"),". However, ",Object(i.b)("inlineCode",{parentName:"p"},"Updates.manifest")," is only present when an update is currently running. If the project is in development, ",Object(i.b)("inlineCode",{parentName:"p"},"Updates.manifest")," will be ",Object(i.b)("inlineCode",{parentName:"p"},"undefined"),". In addition, if a build is running without an update (e.g. it was just downloaded or there are no updates yet), ",Object(i.b)("inlineCode",{parentName:"p"},"Updates.manifest")," will also be ",Object(i.b)("inlineCode",{parentName:"p"},"undefined"),"."),Object(i.b)("h2",{id:"creating-an-envts-file-to-get-environment-variables"},"Creating an Env.ts file to get environment variables"),Object(i.b)("p",null,"Many developers often create a file named ",Object(i.b)("strong",{parentName:"p"},"Env.ts")," in their project, which they import into any file that needs to access environment variables. Combining the information above, we could write the following file to access ",Object(i.b)("inlineCode",{parentName:"p"},"API_URL"),":"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Env.ts")),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-ts"},"import * as Constants from 'expo-constants';\n\nfunction getApiUrl() {\n  const API_URL =\n    Constants.manifest2?.extra?.expoClient?.extra?.eas?.API_URL ??\n    Constants.manifest?.extra?.eas?.API_URL;\n\n  if (!API_URL) {\n    throw new Error('API_URL is missing.');\n  }\n\n  return API_URL;\n}\n\nexport const Env = {\n  API_URL: getApiUrl(),\n};\n")))}s.isMDXComponent=!0},"rh/I":function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/eas-update/environment-variables",function(){return n("f39v")}])}},[["rh/I",1,0]]]);